data$subject_num <-factor(data$subject_num)
data$modality <-factor(data$modality)
data$inten <- factor(data$inten)
# data$target_type <- factor(data$target_type)
data$curve <- factor(data$curve)
})
data.mean<- aggregate(data[col],
by=list(data$subject_num,data$modality,data$inten,data$target_type),
FUN='mean', na.rm=TRUE)
colnames(data.mean)<- c("subject_num","modality","inten",'target_type',"x")
res.aov <- aov(x ~ target_type, data = data.mean)
# print(summary(res.aov))
# data.mean<- aggregate(data[col],
#                       by=list(data$subject_num,data$modality,data$inten),
#                       FUN='mean', na.rm=TRUE)
# colnames(data.mean)<- c("subject_num","modality","inten","x")
# res.aov <- aov(x ~ target_type, data = data.mean)
print(summary(res.aov))
data.aov<-ezANOVA(data=data.mean, dv=x, wid=subject_num, within=c( modality,inten,target_type))
a1 <- aov_ez(id="subject_num",dv= "x", data=data.mean, within=c('modality','inten','target_type')
, anova_table = list(es = "pes"),na.rm=TRUE  )
a1<-aov_ez("subject_num", col,data,
within=c('modality','inten','target_type'), fun_aggregate=mean,na.rm=TRUE)
if(print_result){
print(data.aov)
print('A1')
print(summary(a1))
print("APAPRINT")
print(apa_print(a1, correction = "none", es="pes")$full_result) 													   # get latex and effect sizes with NO spherecity corrections
print(apa_print(a1, correction = "GG", es="pes")$full_result) 														   # get latex and effect sizes WITH spherecity corrections
}
if(print_posthoc){
m1=emmeans(a1,~ inten)
print(summary(as.glht(pairs(m1)), test=adjusted("bonferroni")))
m1=emmeans(a1,~ modality)
print(summary(as.glht(pairs(m1)), test=adjusted("bonferroni")))
m1=emmeans(a1,~ target_type)
print(summary(as.glht(pairs(m1)), test=adjusted("bonferroni")))
}
# m1 = lmer(x ~ modality + inten + target_type +(1|subject_num), data=data.mean)
# print(summary(m1))
}
print_rmanova("success_trial")
print_rmanova("success_trial")
print(data.mean %>%
group_by(modality,inten,target_type) %>%
get_summary_stats(x,type='mean_sd')
)
print(data.mean %>%
group_by(modality,inten,target_type) %>%
get_summary_stats(x,type='mean_sd')
)
View(data.mean)
data <- read_csv(file="SecondStudyRawSummary.csv")
data <- within(data,{
data$subject_num <-factor(data$subject_num)
data$modality <-factor(data$modality)
data$inten <- factor(data$inten)
# data$target_type <- factor(data$target_type)
data$curve <- factor(data$curve)
})
data.mean<- aggregate(data[col],
by=list(data$subject_num,data$modality,data$inten,data$target_type),
FUN='mean', na.rm=TRUE)
colnames(data.mean)<- c("subject_num","modality","inten",'target_type',"x")
print(data.mean %>%
group_by(modality,inten,target_type) %>%
get_summary_stats(x,type='mean_sd')
)
print_rmanova("trial_time",s=TRUE)
col= 'trial_time'
data.mean<- aggregate(data[col],
by=list(data$subject_num,data$modality,data$inten,data$target_type),
FUN='mean', na.rm=TRUE)
colnames(data.mean)<- c("subject_num","modality","inten",'target_type',"x")
print(data.mean %>%
group_by(modality,inten,target_type) %>%
get_summary_stats(x,type='mean_sd')
)
pwc <-data.mean %>% group_by(target_type,modality) %>%
emmeans_test(x ~ inten, p.adjust.method = 'bonferroni')
print(pwc)
data <-data[data$success_trial>0,]
print(data.mean %>%
group_by(modality,inten,target_type) %>%
get_summary_stats(x,type='mean_sd')
)
# SUBJECTIVE
data <- read_csv(file="Subjective_study2.csv")
data <- within(data,{
data$subject_num <-factor(data$subject_num)
data$mm <-factor(data$mm)
data$target_type <- factor(data$target_type)
data$tr <-factor(data$tr)
})
View(data.mean)
#CURVE?
data <- read_csv(file="SecondStudyRawSummary.csv")
data <-data[data$success_trial>0,]
col='trial_time'
data <- within(data,{
data$subject_num <-factor(data$subject_num)
data$modality <-factor(data$modality)
data$inten <- factor(data$inten)
data$target_type <- factor(data$target_type)
data$curve <- factor(data$curve)
})
data.mean<- aggregate(data[col],
by=list(data$subject_num,data$modality,data$inten,data$curve),
FUN='mean', na.rm=TRUE)
View(data.mean)
print(data.mean %>%
group_by(modality,inten,curve) %>%
get_summary_stats(x,type='mean_sd')
)
View(data.mean)
print(data.mean %>%
group_by(modality,inten,target_type) %>%
get_summary_stats(x,type='mean_sd')
)
View(data.mean)
data <- read_csv(file="SecondStudyRawSummary.csv")
data <-data[data$success_trial>0,]
data$target_type <- factor(data$target_type)
data.mean<- aggregate(data[col],
by=list(data$subject_num,data$modality,data$inten,data$target_type),
FUN='mean', na.rm=TRUE)
View(data.mean)
print(data.mean %>%
group_by(modality,inten,target_type) %>%
get_summary_stats(x,type='mean_sd')
)
colnames(data.mean)<- c("subject_num","modality","inten",'target_type',"x")
print(data.mean %>%
group_by(modality,inten,target_type) %>%
get_summary_stats(x,type='mean_sd')
)
print_anova('success_trial')
print(data.mean %>%
group_by(modality,inten,target_type) %>%
get_summary_stats(x,type='mean_sd')
)
print_anova <-function(col,s=FALSE,print_result=TRUE,print_posthoc=TRUE){
data <- read_csv(file="SecondStudyRawSummary.csv")
if (s){
data <-data[data$success_trial>0,]
}
data <- within(data,{
data$subject_num <-factor(data$subject_num)
data$modality <-factor(data$modality)
data$inten <- factor(data$inten)
data$target_type <- factor(data$target_type)
data$curve <- factor(data$curve)
})
data.mean<- aggregate(data[col],
by=list(data$subject_num,data$modality,data$inten,data$target_type),
FUN='mean', na.rm=TRUE)
colnames(data.mean)<- c("subject_num","modality","inten",'target_type',"x")
# data.aov<-ezANOVA(data=data.mean, dv=x, wid=subject_num, within=c( modality,inten,target_type))
# a1 <- aov_ez(id="subject_num",dv= "x", data=data.mean, within=c('modality','inten','target_type')
#              , anova_table = list(es = "pes")
# )
# if(print_result){
#   print(data.aov)
#   print('A1')
#   print(a1)
#   print("APAPRINT")
#   print(apa_print(a1, correction = "none", es="pes")$full_result) 													   # get latex and effect sizes with NO spherecity corrections
#   print(apa_print(a1, correction = "GG", es="pes")$full_result) 														   # get latex and effect sizes WITH spherecity corrections
# }
# if(print_posthoc){
#
#   m1=emmeans(a1,~ inten)
#   print(summary(as.glht(pairs(m1)), test=adjusted("bonferroni")))
# }
print("Simple mean/sd table")
print(data.mean %>%
group_by(modality,inten,target_type) %>%
get_summary_stats(x,type='mean_sd')
)
print("Outlier detection")
print(
data.mean %>%
group_by(modality,inten,target_type) %>%
identify_outliers(x)
)
model <- aov(x ~ modality*inten*target_type, data = data.mean)
# ggqqplot(residuals(model))
print("Normality check : p>0.05 is ok")
print(data.mean %>%
group_by(modality,inten,target_type) %>%
shapiro_test(x)
)
ggqqplot(data.mean,"x",ggtheme=theme_bw()) + facet_grid(modality + inten ~ target_type,labeller='label_both')
bxp <-ggboxplot(data.mean,x="modality",y='x',color = 'inten',facet.by='target_type')
plot(bxp)
print("Homogneity of variance check: p>0.05 is ok")
print(
data.mean %>% levene_test(x ~ modality*inten*target_type) # p>0.05 : ok
)
res.aov <-data.mean %>% anova_test(x ~modality*inten*target_type,effect.size = "pes")
print("Overall ANOVA result")
print(res.aov)
# group the data by target type and fit simple two-way interaction
model <- lm(x ~ modality*inten*target_type, data=data.mean)
print("Post-hoc over two-way interaction : target-type")
print(data.mean %>%
group_by(target_type)%>%
anova_test(x ~ modality * inten,error = model))
print("Post-hoc with multiple pairwise comparison - Inten")
pwc <-data.mean %>% group_by(target_type,modality) %>%
emmeans_test(x ~ inten, p.adjust.method = 'bonferroni')
print(pwc)
print("Post-hoc with multiple pairwise comparison - Target-type")
pwc <-data.mean %>% group_by(inten,modality) %>%
emmeans_test(x ~ target_type, p.adjust.method = 'bonferroni')
print(pwc)
print("Post-hoc with multiple pairwise comparison - Modality")
pwc <-data.mean %>% group_by(target_type,inten) %>%
emmeans_test(x ~ modality, p.adjust.method = 'bonferroni')
print(pwc)
data.curvemean<- aggregate(data[col],
by=list(data$subject_num,data$curve),
FUN='mean', na.rm=TRUE)
colnames(data.curvemean)<- c("subject_num",'curve',"x")
curv_aov <-aov(x ~ curve,data=data.curvemean)
print("One-way ANOVA for curve")
print(summary(curv_aov))
bxp <-ggboxplot(data.curvemean,x="curve",y='x')
plot(bxp)
# print("posthoc")
# print(pairwise.t.test(data.mean$x,data.mean$modality,p.adjust.method = 'bonferroni'))
# print(pairwise.t.test(data.mean$x,data.mean$inten,p.adjust.method = 'bonferroni'))
# print(pairwise.t.test(data.mean$x,data.mean$target_type,p.adjust.method = 'bonferroni'))
}
print_anova('success_trial')
print_anova <-function(col,s=FALSE,print_result=TRUE,print_posthoc=TRUE){
data <- read_csv(file="SecondStudyRawSummary.csv")
if (s){
data <-data[data$success_trial>0,]
}
data <- within(data,{
data$subject_num <-factor(data$subject_num)
data$modality <-factor(data$modality)
data$inten <- factor(data$inten)
data$target_type <- factor(data$target_type)
data$curve <- factor(data$curve)
})
data.mean<- aggregate(data[col],
by=list(data$subject_num,data$modality,data$inten,data$target_type),
FUN='mean', na.rm=TRUE)
colnames(data.mean)<- c("subject_num","modality","inten",'target_type',"x")
# data.aov<-ezANOVA(data=data.mean, dv=x, wid=subject_num, within=c( modality,inten,target_type))
# a1 <- aov_ez(id="subject_num",dv= "x", data=data.mean, within=c('modality','inten','target_type')
#              , anova_table = list(es = "pes")
# )
# if(print_result){
#   print(data.aov)
#   print('A1')
#   print(a1)
#   print("APAPRINT")
#   print(apa_print(a1, correction = "none", es="pes")$full_result) 													   # get latex and effect sizes with NO spherecity corrections
#   print(apa_print(a1, correction = "GG", es="pes")$full_result) 														   # get latex and effect sizes WITH spherecity corrections
# }
# if(print_posthoc){
#
#   m1=emmeans(a1,~ inten)
#   print(summary(as.glht(pairs(m1)), test=adjusted("bonferroni")))
# }
print("Simple mean/sd table")
print(data.mean %>%
group_by(modality,inten) %>%
get_summary_stats(x,type='mean_sd')
)
print("Outlier detection")
print(
data.mean %>%
group_by(modality,inten,target_type) %>%
identify_outliers(x)
)
model <- aov(x ~ modality*inten*target_type, data = data.mean)
# ggqqplot(residuals(model))
print("Normality check : p>0.05 is ok")
print(data.mean %>%
group_by(modality,inten,target_type) %>%
shapiro_test(x)
)
ggqqplot(data.mean,"x",ggtheme=theme_bw()) + facet_grid(modality + inten ~ target_type,labeller='label_both')
bxp <-ggboxplot(data.mean,x="modality",y='x',color = 'inten',facet.by='target_type')
plot(bxp)
print("Homogneity of variance check: p>0.05 is ok")
print(
data.mean %>% levene_test(x ~ modality*inten*target_type) # p>0.05 : ok
)
res.aov <-data.mean %>% anova_test(x ~modality*inten*target_type,effect.size = "pes")
print("Overall ANOVA result")
print(res.aov)
# group the data by target type and fit simple two-way interaction
model <- lm(x ~ modality*inten*target_type, data=data.mean)
print("Post-hoc over two-way interaction : target-type")
print(data.mean %>%
group_by(target_type)%>%
anova_test(x ~ modality * inten,error = model))
print("Post-hoc with multiple pairwise comparison - Inten")
pwc <-data.mean %>% group_by(target_type,modality) %>%
emmeans_test(x ~ inten, p.adjust.method = 'bonferroni')
print(pwc)
print("Post-hoc with multiple pairwise comparison - Target-type")
pwc <-data.mean %>% group_by(inten,modality) %>%
emmeans_test(x ~ target_type, p.adjust.method = 'bonferroni')
print(pwc)
print("Post-hoc with multiple pairwise comparison - Modality")
pwc <-data.mean %>% group_by(target_type,inten) %>%
emmeans_test(x ~ modality, p.adjust.method = 'bonferroni')
print(pwc)
data.curvemean<- aggregate(data[col],
by=list(data$subject_num,data$curve),
FUN='mean', na.rm=TRUE)
colnames(data.curvemean)<- c("subject_num",'curve',"x")
curv_aov <-aov(x ~ curve,data=data.curvemean)
print("One-way ANOVA for curve")
print(summary(curv_aov))
bxp <-ggboxplot(data.curvemean,x="curve",y='x')
plot(bxp)
# print("posthoc")
# print(pairwise.t.test(data.mean$x,data.mean$modality,p.adjust.method = 'bonferroni'))
# print(pairwise.t.test(data.mean$x,data.mean$inten,p.adjust.method = 'bonferroni'))
# print(pairwise.t.test(data.mean$x,data.mean$target_type,p.adjust.method = 'bonferroni'))
}
print_rmanova <-function(col,s=FALSE,print_result=TRUE,print_posthoc=TRUE){
data <- read_csv(file="SecondStudyRawSummary.csv")
if (s){
data <-data[data$success_trial>0,]
}
data <- within(data,{
data$subject_num <-factor(data$subject_num)
data$modality <-factor(data$modality)
data$inten <- factor(data$inten)
data$target_type <- factor(data$target_type)
# data$curve <- factor(data$curve)
})
data.mean<- aggregate(data[col],
by=list(data$subject_num,data$modality,data$inten,data$target_type),
FUN='mean', na.rm=TRUE)
colnames(data.mean)<- c("subject_num","modality","inten",'target_type',"x")
res.aov <- aov(x ~ target_type, data = data.mean)
# print(summary(res.aov))
# data.mean<- aggregate(data[col],
#                       by=list(data$subject_num,data$modality,data$inten),
#                       FUN='mean', na.rm=TRUE)
# colnames(data.mean)<- c("subject_num","modality","inten","x")
# res.aov <- aov(x ~ target_type, data = data.mean)
print(summary(res.aov))
data.aov<-ezANOVA(data=data.mean, dv=x, wid=subject_num, within=c( modality,inten,target_type))
a1 <- aov_ez(id="subject_num",dv= "x", data=data.mean, within=c('modality','inten','target_type')
, anova_table = list(es = "pes"),na.rm=TRUE  )
a1<-aov_ez("subject_num", col,data,
within=c('modality','inten','target_type'), fun_aggregate=mean,na.rm=TRUE)
if(print_result){
print(data.aov)
print('A1')
print(summary(a1))
print("APAPRINT")
print(apa_print(a1, correction = "none", es="pes")$full_result) 													   # get latex and effect sizes with NO spherecity corrections
print(apa_print(a1, correction = "GG", es="pes")$full_result) 														   # get latex and effect sizes WITH spherecity corrections
}
if(print_posthoc){
m1=emmeans(a1,~ inten)
print(summary(as.glht(pairs(m1)), test=adjusted("bonferroni")))
m1=emmeans(a1,~ modality)
print(summary(as.glht(pairs(m1)), test=adjusted("bonferroni")))
m1=emmeans(a1,~ target_type)
print(summary(as.glht(pairs(m1)), test=adjusted("bonferroni")))
}
# m1 = lmer(x ~ modality + inten + target_type +(1|subject_num), data=data.mean)
# print(summary(m1))
}
print_anova('success_trial')
print(data.mean %>%
group_by(modality,inten,target_type) %>%
get_summary_stats(x,type='mean_sd')
)
data <- read_csv(file="SecondStudyRawSummary.csv")
data$subject_num <-factor(data$subject_num)
data.mean<- aggregate(data[col],
by=list(data$subject_num,data$modality,data$inten,data$target_type),
FUN='mean', na.rm=TRUE)
colnames(data.mean)<- c("subject_num","modality","inten",'target_type',"x")
print(data.mean %>%
group_by(modality,inten,target_type) %>%
get_summary_stats(x,type='mean_sd')
)
data.mean<- aggregate(data[col],
by=list(data$subject_num,data$modality,data$inten,data$target_type),
FUN='mean', na.rm=TRUE)
View(data.mean)
colnames(data.mean)<- c("subject_num","modality","inten",'target_type',"x")
print(data.mean %>%
group_by(modality,inten,target_type) %>%
get_summary_stats(x,type='mean_sd')
)
col='success_trial'
data <- read_csv(file="SecondStudyRawSummary.csv")
data$inten <- factor(data$inten)
data.mean<- aggregate(data[col],
by=list(data$subject_num,data$modality,data$inten,data$target_type),
FUN='mean', na.rm=TRUE)
print(data.mean %>%
group_by(modality,inten,target_type) %>%
get_summary_stats(x,type='mean_sd')
)
colnames(data.mean)<- c("subject_num","modality","inten",'target_type',"x")
print(data.mean %>%
group_by(modality,inten,target_type) %>%
get_summary_stats(x,type='mean_sd')
)
for (cn in c(
'success_trial', 'required_target_size', 'trial_time',
'final_speed', 'target_in_count'
))
{
print_dwell_statistics(cn,stand=TRUE,print_result=FALSE,print_posthoc = TRUE)
}
for (cn in c(
'success_trial', 'required_target_size', 'trial_time',
'final_speed', 'target_in_count'
))
{
print_dwell_statistics(cn,stand=TRUE,print_result=TRUE,print_posthoc = TRUE)
}
print_dwell_statistics <- function(col,stand=TRUE,print_result=TRUE,print_posthoc=TRUE){
print(col)
dwell_data = read_csv(file='DwellRawSummary.csv',show_col_types = FALSE)
data = data[-which(is.na(data$target_in_count)), ]
if (stand){
dwell_data <-dwell_data[dwell_data$posture=='STAND',]
}else{
dwell_data <-dwell_data[dwell_data$posture=='WALK',]
}
dwell_data <- within(dwell_data,{
dwell_data$subject_num <-factor(dwell_data$subject_num)
dwell_data$posture <-factor(dwell_data$posture)
dwell_data$cursor_type <- factor(dwell_data$cursor_type)
# dwell_data$dwell_time <- factor(dwell_data$dwell_time )
dwell_data$dwell_time <- factor(dwell_data$dwell_time ,levels=c(0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1.0), labels=c("0.1","0.2","0.3","0.4","0.5","0.6","0.7","0.8","0.9","1.0"))
})
dwell_data.mean <-aggregate(dwell_data[col],
by=list(dwell_data$subject_num,dwell_data$cursor_type,dwell_data$dwell_time),
FUN='mean', na.rm=TRUE)
colnames(dwell_data.mean)<- c("subject_num","cursor_type","dwell_time","x")
dwell_data.mean$dwell_time <- factor(dwell_data.mean$dwell_time ,levels=c(0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1.0), labels=c("0.1","0.2","0.3","0.4","0.5","0.6","0.7","0.8","0.9","1.0"))
dwell_data.aov<-ezANOVA(data=dwell_data.mean, dv=x, wid=subject_num, within=c( cursor_type,dwell_time), white.adjust = TRUE
, detailed = FALSE
, return_aov = FALSE )
a1 <- aov_ez(id="subject_num",dv= "x", data=dwell_data.mean, within=c("cursor_type","dwell_time")
, anova_table = list(es = "pes")
)
if(print_result){
print(dwell_data.aov)
print('A1')
print(a1)
# print("APAPRINT")
# print(apa_print(a1, correction = "none", es="pes")$full_result) 													   # get latex and effect sizes with NO spherecity corrections
# print(apa_print(a1, correction = "GG", es="pes")$full_result) 														   # get latex and effect sizes WITH spherecity corrections
}
if(print_posthoc){
# m1=emmeans(a1,~ dwell_time)
# print(summary(as.glht(pairs(m1)), test=adjusted("bonferroni")))
# m1=emmeans(a1,~ cursor_type)
# print(summary(as.glht(pairs(m1)), test=adjusted("bonferroni")))
# pwc <-dwell_data.mean %>% group_by(cursor_type) %>%
#   emmeans_test(x ~ dwell_time, p.adjust.method = 'bonferroni')
# print(pwc,n=135)
m1=emmeans(a1,~ cursor_type)
print(summary(as.glht(pairs(m1)), test=adjusted("bonferroni")))
print(dwell_data.mean %>%
group_by(cursor_type) %>%
get_summary_stats(x,type='mean_sd')
)
}
}
for (cn in c(
'success_trial', 'required_target_size', 'trial_time',
'final_speed', 'target_in_count'
))
{
print_dwell_statistics(cn,stand=TRUE,print_result=TRUE,print_posthoc = TRUE)
}
for (cn in c(
'success_trial', 'required_target_size'
# , 'trial_time'
# ,'final_speed', 'target_in_count'
))
{
print_dwell_statistics(cn,stand = FALSE,print_result=TRUE,print_posthoc = TRUE)
}
print_basic_statistics('success_trial')
dwell_data = read_csv(file='DwellRawSummary.csv',show_col_types = FALSE)
dwell_data$posture <-factor(dwell_data$posture)
dwell_data.mean <-aggregate(dwell_data[col],
by=list(dwell_data$subject_num,dwell_data$cursor_type,dwell_data$dwell_time),
FUN='mean', na.rm=TRUE)
View(dwell_data.mean)
dwell_data.mean <-aggregate(dwell_data[col],
by=list(dwell_data$cursor_type,dwell_data$dwell_time),
FUN='mean', na.rm=TRUE)
View(dwell_data.mean)
dwell_data <-dwell_data[dwell_data$posture=='STAND',]
dwell_data.mean <-aggregate(dwell_data[col],
by=list(dwell_data$cursor_type,dwell_data$dwell_time),
FUN='mean', na.rm=TRUE)
View(dwell_data.mean)
